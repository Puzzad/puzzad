import{S as I,i as L,s as M,e as A,a as m,g as Y,t as T,c as g,b as z,d as p,o as B,D as N,B as j,h as b,j as v,q,r as k,w as y,n as w,x as C,y as D,l as P,m as R,p as O,C as G}from"./index.d16f85c8.js";import{S as U}from"./Spinner.0c24b5f6.js";function V(f){let t,n,e,r,i,o;function c(a,_){if(a[1].status==="EXPIRED")return K;if(a[1].status==="PAID")return J;if(a[1].status==="ACTIVE")return H}let s=c(f),l=s&&s(f);return{c(){t=b("h1"),n=b("img"),i=v(),l&&l.c(),o=A(),q(n.src,e=f[1].adventures.promoLogo)||k(n,"src",e),k(n,"alt",r=f[1].adventures.name)},m(a,_){m(a,t,_),y(t,n),m(a,i,_),l&&l.m(a,_),m(a,o,_)},p(a,_){_&2&&!q(n.src,e=a[1].adventures.promoLogo)&&k(n,"src",e),_&2&&r!==(r=a[1].adventures.name)&&k(n,"alt",r),s===(s=c(a))&&l?l.p(a,_):(l&&l.d(1),l=s&&s(a),l&&(l.c(),l.m(o.parentNode,o)))},i:w,o:w,d(a){a&&p(t),a&&p(i),l&&l.d(a),a&&p(o)}}}function X(f){let t,n,e,r;return{c(){t=b("h1"),t.textContent="Error finding game",n=v(),e=b("p"),r=C(f[3])},m(i,o){m(i,t,o),m(i,n,o),m(i,e,o),y(e,r)},p(i,o){o&8&&D(r,i[3])},i:w,o:w,d(i){i&&p(t),i&&p(n),i&&p(e)}}}function F(f){let t,n;return t=new U({}),{c(){P(t.$$.fragment)},m(e,r){R(t,e,r),n=!0},p:w,i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){O(t,e)}}}function H(f){let t,n,e,r,i;return{c(){t=b("p"),t.textContent="This adventure is already in progress!",n=v(),e=b("button"),e.textContent="Go to the current puzzle",k(e,"class","svelte-11i0xjd")},m(o,c){m(o,t,c),m(o,n,c),m(o,e,c),r||(i=G(e,"click",f[7]),r=!0)},p:w,d(o){o&&p(t),o&&p(n),o&&p(e),r=!1,i()}}}function J(f){let t,n,e,r=f[0].code+"",i,o,c,s,l,a,_;return{c(){t=b("p"),t.textContent=`You've not yet started your adventure! Remember, it's dangerous to go alone.
            Take this if you want to recruit others to help you:`,n=v(),e=b("code"),i=C(r),o=v(),c=b("p"),c.textContent="Once you're ready, press below to go to the first puzzle in the adventure!",s=v(),l=b("button"),l.textContent="Begin the adventure!",k(e,"class","svelte-11i0xjd"),k(l,"class","svelte-11i0xjd")},m(u,d){m(u,t,d),m(u,n,d),m(u,e,d),y(e,i),m(u,o,d),m(u,c,d),m(u,s,d),m(u,l,d),a||(_=G(l,"click",f[6]),a=!0)},p(u,d){d&1&&r!==(r=u[0].code+"")&&D(i,r)},d(u){u&&p(t),u&&p(n),u&&p(e),u&&p(o),u&&p(c),u&&p(s),u&&p(l),a=!1,_()}}}function K(f){let t,n,e,r,i=Math.round((new Date(f[1].endTime).getTime()-new Date(f[1].startTime).getTime())/10/60)/100+"",o,c;return{c(){t=b("p"),t.textContent="Congratulations! You finished the adventure!",n=v(),e=b("p"),r=C("You took "),o=C(i),c=C(" minutes!")},m(s,l){m(s,t,l),m(s,n,l),m(s,e,l),y(e,r),y(e,o),y(e,c)},p(s,l){l&2&&i!==(i=Math.round((new Date(s[1].endTime).getTime()-new Date(s[1].startTime).getTime())/10/60)/100+"")&&D(o,i)},d(s){s&&p(t),s&&p(n),s&&p(e)}}}function Q(f){let t,n,e,r;const i=[F,X,V],o=[];function c(s,l){return s[2]?0:s[3]||!s[1]?1:2}return t=c(f),n=o[t]=i[t](f),{c(){n.c(),e=A()},m(s,l){o[t].m(s,l),m(s,e,l),r=!0},p(s,[l]){let a=t;t=c(s),t===a?o[t].p(s,l):(Y(),T(o[a],1,1,()=>{o[a]=null}),g(),n=o[t],n?n.p(s,l):(n=o[t]=i[t](s),n.c()),z(n,1),n.m(e.parentNode,e))},i(s){r||(z(n),r=!0)},o(s){T(n),r=!1},d(s){o[t].d(s),s&&p(e)}}}function W(f,t,n){let{params:e={}}=t,r={},i=!0,o,c;B(async function(){var E;try{c=await N(e.code)}catch(S){n(3,o=S.message||S),n(2,i=!1);return}let{data:u,error:d}=await c.from("games").select("status, puzzle, startTime, endTime, adventures ( name, promoLogo, description)").eq("code",e.code);(E=u[0])!=null&&E.adventures?n(1,r=u[0]):d="Unable to find game",d&&n(3,o=d),n(2,i=!1)});const s=async function(){let{data:u}=await c.rpc("startadventure");u&&await j("/game/"+e.code+"/"+u)},l=async function(){await j("/game/"+e.code+"/"+r.puzzle)},a=()=>s(),_=()=>l();return f.$$set=u=>{"params"in u&&n(0,e=u.params)},[e,r,i,o,s,l,a,_]}class h extends I{constructor(t){super(),L(this,t,W,Q,M,{params:0})}}export{h as default};
