import{S as H,i as L,s as q,h as z,b as $,c as p,u as C,t as k,d as b,f as m,g as h,j as E,H as M,k as v,m as w,n as s,l as g,e as d,a as y,B as S,z as A,D as N}from"./index.b67658b9.js";import{S as T}from"./Spinner.c017af1e.js";import{A as j}from"./AdventureLogo.fbf0a8bf.js";import{E as B}from"./Error.64a5909b.js";function D(r){let e,n;return e=new B({props:{error:r[6]}}),{c(){v(e.$$.fragment)},m(t,a){w(e,t,a),n=!0},p:s,i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){g(e,t)}}}function I(r){let e,n,t,a,l=r[2].description+"",i,f,o;n=new j({props:{name:r[2].name}});let u={ctx:r,current:null,token:null,hasCatch:!1,pending:J,then:Y,catch:P,value:5};return z(r[0],u),{c(){e=d("h2"),v(n.$$.fragment),t=y(),a=d("section"),i=y(),f=$(),u.block.c()},m(c,_){p(c,e,_),w(n,e,null),p(c,t,_),p(c,a,_),a.innerHTML=l,p(c,i,_),p(c,f,_),u.block.m(c,u.anchor=_),u.mount=()=>f.parentNode,u.anchor=f,o=!0},p(c,_){r=c,C(u,r,_)},i(c){o||(k(n.$$.fragment,c),o=!0)},o(c){b(n.$$.fragment,c),o=!1},d(c){c&&m(e),g(n),c&&m(t),c&&m(a),c&&m(i),c&&m(f),u.block.d(c),u.token=null,u=null}}}function P(r){return{c:s,m:s,p:s,d:s}}function Y(r){let e;function n(l,i){return l[5]?G:F}let a=n(r)(r);return{c(){a.c(),e=$()},m(l,i){a.m(l,i),p(l,e,i)},p(l,i){a.p(l,i)},d(l){a.d(l),l&&m(e)}}}function F(r){let e;return{c(){e=d("p"),e.innerHTML='You must <a href="/#/login">login</a> before you can start an adventure.'},m(n,t){p(n,e,t)},p:s,d(n){n&&m(e)}}}function G(r){let e,n,t=r[2].price===0?"free":"\xA3"+r[2].price,a,l,i;function f(){return r[4](r[2])}return{c(){e=d("button"),n=S("Start this adventure for "),a=S(t)},m(o,u){p(o,e,u),A(e,n),A(e,a),l||(i=N(e,"click",f),l=!0)},p(o,u){r=o},d(o){o&&m(e),l=!1,i()}}}function J(r){return{c:s,m:s,p:s,d:s}}function K(r){let e,n;return e=new T({}),{c(){v(e.$$.fragment)},m(t,a){w(e,t,a),n=!0},p:s,i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){g(e,t)}}}function O(r){let e,n,t={ctx:r,current:null,token:null,hasCatch:!0,pending:K,then:I,catch:D,value:2,error:6,blocks:[,,,]};return z(r[2],t),{c(){e=$(),t.block.c()},m(a,l){p(a,e,l),t.block.m(a,t.anchor=l),t.mount=()=>e.parentNode,t.anchor=e,n=!0},p(a,[l]){r=a,C(t,r,l)},i(a){n||(k(t.block),n=!0)},o(a){for(let l=0;l<3;l+=1){const i=t.blocks[l];b(i)}n=!1},d(a){a&&m(e),t.block.d(a),t.token=null,t=null}}}function Q(r,e,n){let{params:t={}}=e,a=h.from("adventures").select("id,name,description,price").eq("name",t.name).then(({data:o,error:u})=>{if(u)throw u;return E.set("Puzzad: "+o[0].name),o[0]}),l=h.auth.getSession().then(({data:{session:o}})=>!!(o!=null&&o.user));const i=async o=>{if(o.price===0){let{data:u,error:c}=await h.rpc("addfreeadventure",{adventureid:o.id});u&&await M("/game/"+u)}},f=o=>i(o);return r.$$set=o=>{"params"in o&&n(3,t=o.params)},[l,i,a,t,f]}class X extends H{constructor(e){super(),L(this,e,Q,O,q,{params:3})}}export{X as default};
