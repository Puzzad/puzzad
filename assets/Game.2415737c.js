import{S as G,i as I,s as L,e as q,a as m,g as M,t as T,c as Y,b as z,d as p,o as B,D as N,B as S,h as b,j as v,q as j,r as k,w as y,n as w,x as C,y as D,l as P,m as R,p as g,C as A}from"./index.5738eb95.js";import{S as O}from"./Spinner.4eef8a6b.js";function U(f){let t,n,e,i,r,o;function c(a,_){if(a[1].status==="EXPIRED")return J;if(a[1].status==="PAID")return H;if(a[1].status==="ACTIVE")return F}let s=c(f),l=s&&s(f);return{c(){t=b("h1"),n=b("img"),r=v(),l&&l.c(),o=q(),j(n.src,e=f[1].adventures.promoLogo)||k(n,"src",e),k(n,"alt",i=f[1].adventures.name)},m(a,_){m(a,t,_),y(t,n),m(a,r,_),l&&l.m(a,_),m(a,o,_)},p(a,_){_&2&&!j(n.src,e=a[1].adventures.promoLogo)&&k(n,"src",e),_&2&&i!==(i=a[1].adventures.name)&&k(n,"alt",i),s===(s=c(a))&&l?l.p(a,_):(l&&l.d(1),l=s&&s(a),l&&(l.c(),l.m(o.parentNode,o)))},i:w,o:w,d(a){a&&p(t),a&&p(r),l&&l.d(a),a&&p(o)}}}function V(f){let t,n,e,i;return{c(){t=b("h1"),t.textContent="Error finding game",n=v(),e=b("p"),i=C(f[3])},m(r,o){m(r,t,o),m(r,n,o),m(r,e,o),y(e,i)},p(r,o){o&8&&D(i,r[3])},i:w,o:w,d(r){r&&p(t),r&&p(n),r&&p(e)}}}function X(f){let t,n;return t=new O({}),{c(){P(t.$$.fragment)},m(e,i){R(t,e,i),n=!0},p:w,i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){g(t,e)}}}function F(f){let t,n,e,i,r;return{c(){t=b("p"),t.textContent="This adventure is already in progress!",n=v(),e=b("button"),e.textContent="Go to the current puzzle",k(e,"class","svelte-11i0xjd")},m(o,c){m(o,t,c),m(o,n,c),m(o,e,c),i||(r=A(e,"click",f[7]),i=!0)},p:w,d(o){o&&p(t),o&&p(n),o&&p(e),i=!1,r()}}}function H(f){let t,n,e,i=f[0].code+"",r,o,c,s,l,a,_;return{c(){t=b("p"),t.textContent=`You've not yet started your adventure! Remember, it's dangerous to go alone.
            Take this if you want to recruit others to help you:`,n=v(),e=b("code"),r=C(i),o=v(),c=b("p"),c.textContent="Once you're ready, press below to go to the first puzzle in the adventure!",s=v(),l=b("button"),l.textContent="Begin the adventure!",k(e,"class","svelte-11i0xjd"),k(l,"class","svelte-11i0xjd")},m(u,d){m(u,t,d),m(u,n,d),m(u,e,d),y(e,r),m(u,o,d),m(u,c,d),m(u,s,d),m(u,l,d),a||(_=A(l,"click",f[6]),a=!0)},p(u,d){d&1&&i!==(i=u[0].code+"")&&D(r,i)},d(u){u&&p(t),u&&p(n),u&&p(e),u&&p(o),u&&p(c),u&&p(s),u&&p(l),a=!1,_()}}}function J(f){let t,n,e,i,r=Math.round((new Date(f[1].endTime).getTime()-new Date(f[1].startTime).getTime())/10/60)/100+"",o,c;return{c(){t=b("p"),t.textContent="Congratulations! You finished the adventure!",n=v(),e=b("p"),i=C("You took "),o=C(r),c=C(" minutes!")},m(s,l){m(s,t,l),m(s,n,l),m(s,e,l),y(e,i),y(e,o),y(e,c)},p(s,l){l&2&&r!==(r=Math.round((new Date(s[1].endTime).getTime()-new Date(s[1].startTime).getTime())/10/60)/100+"")&&D(o,r)},d(s){s&&p(t),s&&p(n),s&&p(e)}}}function K(f){let t,n,e,i;const r=[X,V,U],o=[];function c(s,l){return s[2]?0:s[3]||!s[1]?1:2}return t=c(f),n=o[t]=r[t](f),{c(){n.c(),e=q()},m(s,l){o[t].m(s,l),m(s,e,l),i=!0},p(s,[l]){let a=t;t=c(s),t===a?o[t].p(s,l):(M(),T(o[a],1,1,()=>{o[a]=null}),Y(),n=o[t],n?n.p(s,l):(n=o[t]=r[t](s),n.c()),z(n,1),n.m(e.parentNode,e))},i(s){i||(z(n),i=!0)},o(s){T(n),i=!1},d(s){o[t].d(s),s&&p(e)}}}function Q(f,t,n){let{params:e={}}=t,i={},r=!0,o,c;B(async function(){var E;c=await N(e.code);let{data:u,error:d}=await c.from("games").select("status, puzzle, startTime, endTime, adventures ( name, promoLogo, description)").eq("code",e.code);(E=u[0])!=null&&E.adventures?n(1,i=u[0]):d="Unable to find game",d&&n(3,o=d),n(2,r=!1)});const s=async function(){let{data:u}=await c.rpc("startadventure");u&&await S("/game/"+e.code+"/"+u)},l=async function(){await S("/game/"+e.code+"/"+i.puzzle)},a=()=>s(),_=()=>l();return f.$$set=u=>{"params"in u&&n(0,e=u.params)},[e,i,r,o,s,l,a,_]}class $ extends G{constructor(t){super(),I(this,t,Q,K,L,{params:0})}}export{$ as default};
