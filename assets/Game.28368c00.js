import{S as I,i as L,s as x,e as T,a as p,g as B,t as C,c as D,b as z,d as _,o as N,z as P,A as E,l as b,p as y,q as S,r as k,w,n as v,x as j,y as q,j as R,m as Y,k as g,B as G}from"./index.f6a43aeb.js";import{S as M}from"./Spinner.e62bfd13.js";function O(f){let e,t,n,i,a,s;function c(r,m){if(r[1].status==="EXPIRED")return H;if(r[1].status==="PAID")return F;if(r[1].status==="ACTIVE")return X}let l=c(f),o=l&&l(f);return{c(){e=b("h1"),t=b("img"),a=y(),o&&o.c(),s=T(),S(t.src,n=f[1].adventures.promoLogo)||k(t,"src",n),k(t,"alt",i=f[1].adventures.name)},m(r,m){p(r,e,m),w(e,t),p(r,a,m),o&&o.m(r,m),p(r,s,m)},p(r,m){m&2&&!S(t.src,n=r[1].adventures.promoLogo)&&k(t,"src",n),m&2&&i!==(i=r[1].adventures.name)&&k(t,"alt",i),l===(l=c(r))&&o?o.p(r,m):(o&&o.d(1),o=l&&l(r),o&&(o.c(),o.m(s.parentNode,s)))},i:v,o:v,d(r){r&&_(e),r&&_(a),o&&o.d(r),r&&_(s)}}}function U(f){let e,t,n,i;return{c(){e=b("h1"),e.textContent="Error finding game",t=y(),n=b("p"),i=j(f[3])},m(a,s){p(a,e,s),p(a,t,s),p(a,n,s),w(n,i)},p(a,s){s&8&&q(i,a[3])},i:v,o:v,d(a){a&&_(e),a&&_(t),a&&_(n)}}}function V(f){let e,t;return e=new M({}),{c(){R(e.$$.fragment)},m(n,i){Y(e,n,i),t=!0},p:v,i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){C(e.$$.fragment,n),t=!1},d(n){g(e,n)}}}function X(f){let e,t,n,i,a;return{c(){e=b("p"),e.textContent="This adventure is already in progress!",t=y(),n=b("button"),n.textContent="Go to the current puzzle",k(n,"class","svelte-11i0xjd")},m(s,c){p(s,e,c),p(s,t,c),p(s,n,c),i||(a=G(n,"click",f[7]),i=!0)},p:v,d(s){s&&_(e),s&&_(t),s&&_(n),i=!1,a()}}}function F(f){let e,t,n,i=f[0].code+"",a,s,c,l,o,r,m;return{c(){e=b("p"),e.textContent=`You've not yet started your adventure! Remember, it's dangerous to go alone.
            Take this if you want to recruit others to help you:`,t=y(),n=b("code"),a=j(i),s=y(),c=b("p"),c.textContent="Once you're ready, press below to go to the first puzzle in the adventure!",l=y(),o=b("button"),o.textContent="Begin the adventure!",k(n,"class","svelte-11i0xjd"),k(o,"class","svelte-11i0xjd")},m(u,d){p(u,e,d),p(u,t,d),p(u,n,d),w(n,a),p(u,s,d),p(u,c,d),p(u,l,d),p(u,o,d),r||(m=G(o,"click",f[6]),r=!0)},p(u,d){d&1&&i!==(i=u[0].code+"")&&q(a,i)},d(u){u&&_(e),u&&_(t),u&&_(n),u&&_(s),u&&_(c),u&&_(l),u&&_(o),r=!1,m()}}}function H(f){let e;return{c(){e=b("p"),e.textContent="Congratulations! You finished the adventure!"},m(t,n){p(t,e,n)},p:v,d(t){t&&_(e)}}}function J(f){let e,t,n,i;const a=[V,U,O],s=[];function c(l,o){return l[2]?0:l[3]||!l[1]?1:2}return e=c(f),t=s[e]=a[e](f),{c(){t.c(),n=T()},m(l,o){s[e].m(l,o),p(l,n,o),i=!0},p(l,[o]){let r=e;e=c(l),e===r?s[e].p(l,o):(B(),C(s[r],1,1,()=>{s[r]=null}),D(),t=s[e],t?t.p(l,o):(t=s[e]=a[e](l),t.c()),z(t,1),t.m(n.parentNode,n))},i(l){i||(z(t),i=!0)},o(l){C(t),i=!1},d(l){s[e].d(l),l&&_(n)}}}function K(f,e,t){let{params:n={}}=e,i={},a=!0,s,c;N(async function(){var A;c=await P(n.code);let{data:u,error:d}=await c.from("games").select("status, puzzle, startTime, endTime, adventures ( name, promoLogo, description)").eq("code",n.code);(A=u[0])!=null&&A.adventures?t(1,i=u[0]):d="Unable to find game",d&&t(3,s=d),t(2,a=!1)});const l=async function(){let{data:u}=await c.rpc("startadventure");u&&await E("/game/"+n.code+"/"+u)},o=async function(){await E("/game/"+n.code+"/"+i.puzzle)},r=()=>l(),m=()=>o();return f.$$set=u=>{"params"in u&&t(0,n=u.params)},[n,i,a,s,l,o,r,m]}class Z extends I{constructor(e){super(),L(this,e,K,J,x,{params:0})}}export{Z as default};
